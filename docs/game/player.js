"use strict";const xAirDrag=.95,xGroundDrag=.85,yAirDrag=.975,yWallDrag=.9,jumpVelocity=13,airAcceleration=.4,groundAcceleration=1,jumpGravity=.15,gravity=.75,wallJumpTime=.2,endJumpSpeed=6;class Player{constructor(i){this.id=i,this.collider=new Collision(1,1),this.onGround=!1,this.onRightWall=!1,this.onLeftWall=!1,this.jumping=!1,this.leftWallTimer=0,this.rightWallTimer=0,this.inventory=new Inventory,this.inventory.addTile("65a5fce8876d8e5bad5da510edb9a30f"),this.inventory.addTile("bcaadcad2211c75bc25db581cb424d00"),this.colour="#"+Math.floor(Math.random()*Math.pow(2,24)).toString(16).padStart(6,"0")}update(i){this.collider.vy-=this.jumping?jumpGravity:gravity,this.leftWallTimer-=1/60,this.rightWallTimer-=1/60,i.held[37]&&(this.collider.vx-=this.onGround?groundAcceleration:airAcceleration),i.held[39]&&(this.collider.vx+=this.onGround?groundAcceleration:airAcceleration),i.held[40],this.onGround&&i.down[38]&&(this.collider.vy=jumpVelocity,this.jumping=!0),this.leftWallTimer>0&&i.down[38]&&(this.collider.vy=jumpVelocity/4*3,this.collider.vx=jumpVelocity/3*2,this.leftWallTimer=0,this.jumping=!0),this.rightWallTimer>0&&i.down[38]&&(this.collider.vy=jumpVelocity/4*3,this.collider.vx=-jumpVelocity/3*2,this.rightWallTimer=0,this.jumping=!0),(this.collider.vy<endJumpSpeed||!i.held[38])&&(this.jumping=!1);let l=this.collider.vx,t=this.collider.vy,[e,r]=this.collider.slide(1/60);this.onLeftWall=l<0&&0===this.collider.vx,this.onRightWall=l>0&&0===this.collider.vx,this.onGround=t<0&&0===this.collider.vy,this.onLeftWall&&(this.leftWallTimer=wallJumpTime),this.onRightWall&&(this.rightWallTimer=wallJumpTime);let o=this.onGround?xGroundDrag:xAirDrag,a=!this.onLeftWall&&!this.onRightWall||this.jumping?yAirDrag:yWallDrag,h=0*(1/o-1),s=0*(1/a-1);this.collider.vx=(this.collider.vx+h)*o,this.collider.vy=(this.collider.vy+s)*a,camera.scroll(this.collider.x,this.collider.y,.1)}draw(){canvasContext.fillStyle=this.colour;const i=camera.toScreen(this.collider.x,this.collider.y);canvasContext.fillRect(i.x-camera.zoom/2,i.y-camera.zoom/2,camera.zoom,camera.zoom),this.inventory.draw()}}
